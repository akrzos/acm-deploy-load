---
# Playbook to create manifests for telco core cluster(s)
#
# To make BM Telco Core Manifests, set ocp_inventory to the path to the ocpinventory.json file
# and run the playbook.
#
# To make VM Telco Core Manifests use an inventory file generated by jetlag that has hypervisors and VMs
#
# For now those are mutually exclusive, either single BM Telco Core or one or more VM Telco Core clusters
#
# Example Usage:
#
# time ansible-playbook -i ansible/inventory/cloud18.local ansible/telco-core-manifests.yml
#

- name: Create manifests to create Telco Core Cluster(s)
  hosts: bastion
  gather_facts: false
  vars_files:
  - vars/all.yml
  - vars/telco-core.yml
  vars:
    telco_core_clusters: []
  roles:
  - role: telco-core-bm-inventory
    when: ocp_inventory is defined and ocp_inventory is not none
  - role: telco-core-vm-inventory
    when: '"hv_vm" in groups and (ocp_inventory is not defined or ocp_inventory is none)'
  - role: telco-core-manifests
    when: telco_core_clusters | length > 0
